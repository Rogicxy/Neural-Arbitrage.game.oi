<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEURAL ARBITRAGE | LIVE MAINNET</title>
    <style>
        :root {
            --bg: #020005;
            --widget: #080812;
            --neon-blue: #00d2ff;
            --neon-pink: #ff007a;
            --neon-green: #39ff14;
            --neon-red: #ff3131;
            --neon-gold: #ffcc00;
        }

        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: #fff; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        
        /* ПРОФИЛЬ */
        .profile-corner { position: fixed; top: 15px; right: 15px; display: flex; flex-direction: column; align-items: center; z-index: 100; cursor: pointer; background: rgba(8,8,18,0.95); padding: 12px; border-radius: 15px; border: 1px solid var(--neon-blue); box-shadow: 0 0 15px rgba(0,210,255,0.2); }
        .avatar { width: 55px; height: 55px; background-size: cover; background-position: center; border-radius: 50%; border: 2px solid var(--neon-blue); }
        .nickname { font-size: 0.8em; color: var(--neon-blue); margin-top: 5px; font-weight: bold; }
        .lvl-badge { background: #000; color: var(--neon-gold); padding: 2px 10px; border-radius: 20px; font-size: 0.8em; margin-top: -8px; border: 1px solid var(--neon-gold); font-weight: bold; }
        .xp-container { width: 80px; height: 6px; background: #222; border-radius: 10px; margin-top: 8px; overflow: hidden; }
        #xp-fill { width: 0%; height: 100%; background: var(--neon-blue); transition: 0.5s; }

        /* МОДАЛКА */
        #profile-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--widget); border: 2px solid var(--neon-blue); padding: 25px; border-radius: 15px; z-index: 1000; width: 300px; box-shadow: 0 0 100px #000; }
        #profile-modal input { width: 100%; background: #000; border: 1px solid #333; color: #fff; padding: 12px; margin: 10px 0; border-radius: 5px; box-sizing: border-box; }

        .game-title { font-size: 2em; letter-spacing: 6px; color: var(--neon-blue); text-shadow: 0 0 15px var(--neon-blue); margin: 20px 0; text-transform: uppercase; }
        .main-layout { display: grid; grid-template-columns: 1fr 320px; gap: 20px; width: 100%; max-width: 1200px; }
        
        .stats-panel { display: flex; gap: 10px; grid-column: 1 / -1; }
        .stat-box { flex: 1; background: var(--widget); border: 1px solid #1a1a2e; border-radius: 12px; padding: 15px; text-align: center; }
        .stat-box .val { font-size: 1.6em; font-weight: bold; font-family: monospace; }

        .news-box { grid-column: 1 / -1; background: #050505; border: 1px solid #222; padding: 18px; border-radius: 8px; text-align: center; font-weight: bold; margin-bottom: 5px; min-height: 25px; transition: 0.3s; }

        .market-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; }
        .card { background: var(--widget); border-radius: 15px; border: 1px solid #1a1a2e; padding: 20px; position: relative; }
        
        .bot-label { position: absolute; top: 12px; left: 12px; background: var(--neon-blue); color: #000; font-size: 0.6em; padding: 2px 8px; border-radius: 4px; font-weight: bold; display: none; box-shadow: 0 0 10px var(--neon-blue); z-index: 5; }

        .chart-box { height: 120px; width: 100%; background: #000; margin: 15px 0; border-radius: 5px; border: 1px solid #111; overflow: hidden; }
        canvas { width: 100%; height: 100%; }

        .trade-row { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
        .qty-ctrl { display: flex; align-items: center; background: #000; border-radius: 5px; border: 1px solid #333; }
        .qty-btn { background: #1a1a2e; color: #fff; padding: 5px 12px; font-weight: bold; cursor: pointer; border: none; }
        .qty-val { width: 40px; text-align: center; color: var(--neon-blue); font-weight: bold; }

        .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        button { cursor: pointer; border: none; border-radius: 6px; font-weight: bold; transition: 0.2s; }
        .btn-buy { background: var(--neon-green); color: #000; padding: 12px; }
        .btn-sell { background: var(--neon-red); color: #fff; padding: 12px; }

        .shop-panel { background: var(--widget); border-radius: 12px; border: 1px solid #1a1a2e; padding: 20px; }
        .shop-item { background: #000; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #222; }

        .leaderboard { grid-column: 1 / -1; background: var(--widget); border-radius: 15px; border: 1px solid #1a1a2e; padding: 20px; margin-top: 20px; width: 100%; box-sizing: border-box; }
        .leader-table { width: 100%; border-collapse: collapse; }
        .leader-table th { text-align: left; color: #444; padding: 10px; border-bottom: 2px solid #111; }
        .leader-table td { padding: 12px 10px; border-bottom: 1px solid #111; }
        .me-row { background: rgba(0, 210, 255, 0.15); color: var(--neon-blue); }

        .audio-ctrl { position: fixed; bottom: 15px; left: 15px; background: var(--widget); padding: 10px 15px; border: 1px solid var(--neon-blue); border-radius: 50px; z-index: 100; }
        
        @keyframes panic { 0% { box-shadow: 0 0 5px #f00; } 50% { box-shadow: 0 0 35px #f00; background: #200; } 100% { box-shadow: 0 0 5px #f00; } }
        .panic-mode { animation: panic 0.2s infinite; border: 2px solid #f00 !important; }
    </style>
</head>
<body>

<div id="profile-modal">
    <h3 style="color:var(--neon-blue); margin-top:0;">ПРОФИЛЬ ТРЕЙДЕРА</h3>
    <input type="text" id="nick-input" placeholder="Ваш ник...">
    <input type="text" id="img-input" placeholder="Ссылка на фото (URL)...">
    <button class="btn-buy" style="width:100%" onclick="saveProfile()">СОХРАНИТЬ</button>
</div>

<div class="audio-ctrl">
    <audio id="bg-music" loop><source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3" type="audio/mpeg"></audio>
    <button onclick="toggleMusic()" id="m-btn" style="background:var(--neon-blue); color:#000; border:none; border-radius:20px; font-size:0.7em; padding: 6px 14px; cursor:pointer; font-weight:bold;">MUSIC: OFF</button>
</div>

<div class="profile-corner" onclick="openProfile()">
    <div class="avatar" id="user-avatar" style="background-image: url('https://api.dicebear.com/7.x/bottts/svg?seed=Lucky')"></div>
    <div class="nickname" id="user-nick">TRADER_X</div>
    <div class="lvl-badge" id="lvl-display">LVL 1</div>
    <div class="xp-container"><div id="xp-fill"></div></div>
</div>

<div class="game-title">Neural Arbitrage v1.0</div>

<div class="main-layout">
    <div class="stats-panel">
        <div class="stat-box">
            <div style="font-size: 0.7em; color: #666; margin-bottom: 5px;">БАЛАНС N-COIN</div>
            <div class="val" id="balance" style="color: var(--neon-green)">1000.00</div>
        </div>
        <div class="stat-box">
            <div style="font-size: 0.7em; color: #666; margin-bottom: 5px;">СТОИМОСТЬ ПОРТФЕЛЯ</div>
            <div class="val" id="asset-value" style="color: var(--neon-pink)">0.00</div>
        </div>
    </div>

    <div class="news-box" id="news-line">>>> СИСТЕМА ИНИЦИАЛИЗИРОВАНА...</div>

    <div class="market-grid" id="market"></div>

    <aside class="shop-panel">
        <h3 style="color:var(--neon-pink); margin-top:0; font-size:0.9em;">МАГАЗИН</h3>
        <div class="shop-item">
            <b style="color:var(--neon-gold)">ASIC МАЙНЕР</b><br>
            <small id="farm-info">Доход: $0/сек</small>
            <button class="btn-buy" style="width:100%; margin-top:10px;" onclick="buyFarm()">КУПИТЬ: <span id="farm-cost">2000</span></button>
        </div>
        <div id="bot-shop-area"></div>
    </aside>

    <div class="leaderboard">
        <h3 style="margin:0 0 15px 0; color:var(--neon-gold);">РЕЙТИНГ МИРОВЫХ ИГРОКОВ</h3>
        <table class="leader-table" id="leader-list"></table>
    </div>
</div>

<script>
    // --- ПЕРЕМЕННЫЕ СОСТОЯНИЯ ---
    let state = {
        cash: 1000, // СТРОКА 208
        xp: 0, lvl: 1, nick: "Trader_X",
        avatar: "https://api.dicebear.com/7.x/bottts/svg?seed=Lucky",
        passive: 0, farmLvl: 0, farmCost: 2000,
        assets: [
            { id: 'btc', name: 'BIT-PULSE', base: 100, price: 100, history: Array(60).fill(100), owned: 0, volt: 0.035, hasBot: false, qty: 1 },
            { id: 'eth', name: 'NEURO-LINK', base: 45, price: 45, history: Array(60).fill(45), owned: 0, volt: 0.03, hasBot: false, qty: 1 },
            { id: 'omega', name: 'OMEGA-SHARD', base: 500, price: 500, history: Array(60).fill(500), owned: 0, volt: 0.08, hasBot: false, qty: 1 }
        ]
    };

    const botsPrices = { btc: 5000, eth: 10000, omega: 50000 };
    let globalMods = { btc: 1, eth: 1, omega: 1 };

    // --- НОВОСТИ С ЛИЧНОСТЯМИ ---
    const vipNews = [
        { t: "ИЛОН МАСК: 'КРИПТА - ЭТО БУДУЩЕЕ!' (BTC PUMP x5)", m: 5, target: 'btc', c: 'var(--neon-green)' },
        { t: "ВИТАЛИК БУТЕРИН ОБНОВИЛ NEURO-LINK (ETH PUMP x3)", m: 3, target: 'eth', c: 'var(--neon-green)' },
        { t: "ФРС ПОВЫШАЕТ СТАВКУ: РЫНОК В ПАНИКЕ (DUMP x0.2)", m: 0.2, target: 'all', c: 'var(--neon-red)' },
        { t: "OMEGA-SHARD ВЗЛОМАН ХАКЕРАМИ! (CRASH x0.1)", m: 0.1, target: 'omega', c: 'var(--neon-red)' },
        { t: "ЧАНПЭН ЧЖАО ЗАПУСКАЕТ НОВЫЙ ФОНД (RECOVERY x4)", m: 4, target: 'all', c: 'var(--neon-blue)' }
    ];

    function save() { localStorage.setItem('na_pro_save', JSON.stringify(state)); }
    function load() {
        const data = localStorage.getItem('na_pro_save');
        if (data) {
            state = {...state, ...JSON.parse(data)};
            document.getElementById('user-nick').innerText = state.nick;
            document.getElementById('user-avatar').style.backgroundImage = `url('${state.avatar}')`;
            document.getElementById('farm-info').innerText = `Доход: $${Math.floor(state.passive)}/сек`;
            document.getElementById('farm-cost').innerText = state.farmCost;
        }
    }

    function init() {
        load(); renderMarket(); renderBotShop(); updateLeaderboard();
        setInterval(tick, 700);
        setInterval(rollNews, 25000);
        setInterval(() => { state.cash += state.passive; addXP(0.5); updateStats(); }, 1000);
        setInterval(botLogic, 1500);
        setInterval(save, 5000);
    }

    function rollNews() {
        const n = vipNews[Math.floor(Math.random()*vipNews.length)];
        const el = document.getElementById('news-line');
        el.innerText = `>>> ${n.t}`; el.style.color = n.c;
        if(n.target === 'all') {
            Object.keys(globalMods).forEach(k => globalMods[k] = n.m);
        } else {
            globalMods[n.target] = n.m;
        }
        setTimeout(() => { 
            Object.keys(globalMods).forEach(k => globalMods[k] = 1); 
            el.style.color = '#888';
        }, 12000);
    }

    function tick() {
        state.assets.forEach(a => {
            let change = (Math.random() - 0.46) * 2 * a.volt;
            if (a.price < a.base * 0.5) change = Math.abs(change) + 0.04;
            if (Math.random() < 0.01) change = 1.5; // Случайный прострел

            const card = document.getElementById(`card-${a.id}`);
            if (a.price > (a.base * 20)) {
                card.classList.add('panic-mode');
                if (Math.random() < 0.3) { a.price /= 150; card.classList.remove('panic-mode'); }
            } else { card.classList.remove('panic-mode'); }

            let move = (change + 0.001) * globalMods[a.id];
            a.price *= (1 + move); a.price = Math.max(0.01, a.price);
            a.history.push(a.price); a.history.shift();

            document.getElementById(`p-${a.id}`).innerText = a.price.toFixed(2);
            document.getElementById(`p-${a.id}`).style.color = move >= 0 ? 'var(--neon-green)' : 'var(--neon-red)';
            drawChart(a);
        });
        updateStats();
    }

    function drawChart(a) {
        const canvas = document.getElementById(`c-${a.id}`);
        const ctx = canvas.getContext('2d');
        const w = canvas.width = canvas.offsetWidth, h = canvas.height = canvas.offsetHeight;
        let min = Math.min(...a.history) * 0.9, max = Math.max(...a.history) * 1.1;
        ctx.clearRect(0,0,w,h); ctx.beginPath(); ctx.lineWidth = 3;
        ctx.strokeStyle = a.price >= a.history[a.history.length-2] ? '#39ff14' : '#ff3131';
        a.history.forEach((v, i) => {
            let x = (i/59)*w, y = h - ((v-min)/(max-min))*h;
            if(i==0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
        });
        ctx.stroke();
    }

    function renderMarket() {
        document.getElementById('market').innerHTML = state.assets.map(a => `
            <div class="card" id="card-${a.id}">
                <div class="bot-label" id="bot-tag-${a.id}" style="${a.hasBot ? 'display:block' : ''}">BOT ACTIVE</div>
                <div style="display:flex; justify-content:space-between"><b>${a.name}</b><span id="p-${a.id}" style="font-family:monospace">0</span></div>
                <div class="chart-box"><canvas id="c-${a.id}"></canvas></div>
                <div class="trade-row">
                    <small>В наличии: <span id="h-${a.id}">${a.owned}</span></small>
                    <div class="qty-ctrl">
                        <button class="qty-btn" onclick="changeQty('${a.id}', -1)">-</button>
                        <div class="qty-val" id="q-${a.id}">${a.qty}</div>
                        <button class="qty-btn" onclick="changeQty('${a.id}', 1)">+</button>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn-buy" onclick="trade('${a.id}', 'buy')">BUY</button>
                    <button class="btn-sell" onclick="trade('${a.id}', 'sell')">SELL</button>
                </div>
            </div>
        `).join('');
    }

    function changeQty(id, delta) {
        const a = state.assets.find(x => x.id === id);
        a.qty = Math.max(1, a.qty + delta);
        document.getElementById(`q-${id}`).innerText = a.qty;
    }

    function trade(id, mode) {
        const a = state.assets.find(x => x.id === id);
        let total = a.price * a.qty;
        if (mode === 'buy' && state.cash >= total) { state.cash -= total; a.owned += a.qty; addXP(10 * a.qty); } 
        else if (mode === 'sell' && a.owned >= a.qty) { state.cash += total; a.owned -= a.qty; addXP(8 * a.qty); }
        document.getElementById(`h-${id}`).innerText = a.owned;
        updateStats();
    }

    function botLogic() {
        state.assets.forEach(a => {
            if(a.hasBot) {
                let avg = a.history.reduce((s,v)=>s+v,0)/60;
                if(a.price < avg * 0.92 && state.cash >= a.price) { state.cash -= a.price; a.owned++; }
                if(a.price > avg * 1.08 && a.owned > 0) { state.cash += a.price; a.owned--; }
                document.getElementById(`h-${a.id}`).innerText = a.owned;
            }
        });
    }

    function renderBotShop() {
        document.getElementById('bot-shop-area').innerHTML = state.assets.map(a => `
            <div class="shop-item">
                <b style="color:var(--neon-green)">БОТ: ${a.name}</b><br>
                <button class="btn-buy" style="width:100%; margin-top:10px; background:var(--neon-pink); color:#fff" 
                    onclick="buyBot('${a.id}')" ${a.hasBot ? 'disabled' : ''}>
                    ${a.hasBot ? 'АКТИВИРОВАН' : 'КУПИТЬ: $' + botsPrices[a.id]}
                </button>
            </div>
        `).join('');
    }

    function buyBot(id) {
        const a = state.assets.find(x => x.id === id);
        if (state.cash >= botsPrices[id] && !a.hasBot) {
            state.cash -= botsPrices[id]; a.hasBot = true;
            document.getElementById(`bot-tag-${id}`).style.display = 'block';
            renderBotShop(); addXP(1000);
        }
    }

    function buyFarm() {
        if (state.cash >= state.farmCost) {
            state.cash -= state.farmCost; state.passive += 35; state.farmLvl++; state.farmCost *= 3;
            document.getElementById('farm-info').innerText = `Доход: $${state.passive}/сек`;
            document.getElementById('farm-cost').innerText = state.farmCost;
        }
    }

    function addXP(val) {
        state.xp += val;
        let next = 200 * Math.pow(2.5, state.lvl - 1);
        if (state.xp >= next) { state.xp = 0; state.lvl++; state.cash += 1000 * state.lvl; }
        document.getElementById('lvl-display').innerText = `LVL ${state.lvl}`;
        document.getElementById('xp-fill').style.width = (state.xp / next * 100) + "%";
    }

    function updateStats() {
        document.getElementById('balance').innerText = state.cash.toFixed(2);
        let port = state.assets.reduce((s, a) => s + (a.owned * a.price), 0);
        document.getElementById('asset-value').innerText = port.toFixed(2);
        updateLeaderboard();
    }

    function updateLeaderboard() {
        const players = [
            { n: "Elon Musk", b: 999999999 },
            { n: "Vitalik B.", b: 5000000 },
            { n: "CryptoWhale", b: 1200000 },
            { n: state.nick + " (ВЫ)", b: state.cash + state.assets.reduce((s, a) => s + (a.owned * a.price), 0), me: true }
        ].sort((a,b) => b.b - a.b);

        document.getElementById('leader-list').innerHTML = `
            <tr><th>#</th><th>ИГРОК</th><th>NET WORTH</th></tr>
            ${players.map((p, i) => `<tr class="${p.me ? 'me-row' : ''}"><td>${i+1}</td><td>${p.n}</td><td>$${Math.floor(p.b).toLocaleString()}</td></tr>`).join('')}
        `;
    }

    function openProfile() { document.getElementById('profile-modal').style.display = 'block'; }
    function saveProfile() {
        const n = document.getElementById('nick-input').value;
        const i = document.getElementById('img-input').value;
        if(n) { state.nick = n; document.getElementById('user-nick').innerText = n; }
        if(i) { state.avatar = i; document.getElementById('user-avatar').style.backgroundImage = `url('${i}')`; }
        document.getElementById('profile-modal').style.display = 'none';
        save();
    }

    function toggleMusic() {
        const m = document.getElementById('bg-music'); const b = document.getElementById('m-btn');
        if (m.paused) { m.play(); m.volume = 0.2; b.innerText = "MUSIC: ON"; } else { m.pause(); b.innerText = "MUSIC: OFF"; }
    }

    window.onload = init;
</script>
</body>
      </html>
